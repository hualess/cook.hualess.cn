import{f as $,o as n,c as l,k as q,B as U,m as O,h as m,C as N,q as M,D as X,i as Y,E as A,G as J,H as K,I as Q,J as Z,j as a,a as e,F as S,r as B,t as k,l as D,K as ee,b as x,g as j,w as T,T as W,L as G,M as z,N as te,y as ne,d as oe}from"./DnIBYzVF.js";import{_ as se}from"./DIueFxfN.js";import{_ as H}from"./DlAUqK2U.js";import{_ as le,v as ae,m as ie,s as ce,t as re}from"./t7AyP0FB.js";import{_ as ue}from"./PX8Qbd30.js";const de=["bg","text"],_e=$({__name:"VegetableTag",props:{active:{type:Boolean}},setup(d){return(t,c)=>(n(),l("span",{class:"vegetable-tag rounded tag",p:"x-2",border:"~ green-200 dark:green-800",bg:t.active?"green-600 opacity-90":"green-300 opacity-20",text:t.active?"green-100":"green-800 dark:green-200"},[q(t.$slots,"default")],8,de))}}),pe=["bg","text"],fe=$({__name:"MeatTag",props:{active:{type:Boolean}},setup(d){return(t,c)=>(n(),l("span",{class:"meat-tag rounded tag",p:"x-2",border:"~ red-200 dark:red-800",bg:t.active?"red-500 opacity-90":"red-300 opacity-20",text:t.active?"red-100":"red-800 dark:red-200"},[q(t.$slots,"default")],8,pe))}}),ve=["bg","text"],he=$({__name:"ToolTag",props:{active:{type:Boolean}},setup(d){return(t,c)=>(n(),l("span",{class:"rounded tag",p:"x-2",border:"~ stone-200 dark:stone-600",bg:t.active?"stone-600 opacity-100":"stone-300 opacity-5",text:t.active?"stone-100":"stone-800 dark:stone-200"},[q(t.$slots,"default")],8,ve))}}),P="cook",V=U("recipe",()=>{const d=J(),{settings:t}=O(),c=m(""),i=t.keepLocalData?N(`${P}:stuff`,new Set):m(new Set),s=t.keepLocalData?N(`${P}:tool`,""):m(""),_=t.keepLocalData?N(`${P}:mode`,"loose"):m("loose"),p=M(()=>Array.from(i.value));function u(r){i.value&&(i.value.has(r)?i.value.delete(r):i.value.add(r))}function C(r){s.value===r?s.value="":s.value=r}function R(r){_.value=r}function b(){i.value.clear(),s.value=""}function g(r){i.value.add(r)}const y=m(!1);async function w(){y.value=!0;let r=[];return _.value==="strict"?r=await A.recipes.filter(f=>{const o=p.value.every(h=>f.stuff.includes(h)),v=f.tools.includes(s.value);return s.value?o&&v:o}).toArray():_.value==="loose"?r=await A.recipes.filter(f=>{var h;const o=p.value.some(L=>f.stuff.includes(L)),v=!!((h=f.tools)!=null&&h.includes(s.value));return s.value&&p.value.length?o&&v:p.value.length?o:s.value?v:!1}).toArray():r=await A.recipes.filter(f=>{var h;const o=f.stuff.every(L=>p.value.includes(L)),v=(h=f.tools)==null?void 0:h.includes(s.value);return!!(s.value?o&&v:o)}).toArray(),c.value&&(r=r.filter(f=>f.name.includes(c.value))),y.value=!1,r}const F=m([]);X(()=>[c.value,p.value,s.value,_.value],async()=>{F.value=[...await w()]});const I=r=>{const f=r.name;C(f),d==null||d.trackEvent({event:"click",category:`tool_${f}`,action:"click_tool",label:"工具"}),d==null||d.trackEvent({event:"click_tool",action:r.name})},E=m(0);return Y(async()=>{A.recipes.count().then(r=>{E.value=r}),F.value=await w()}),{recipesLength:E,keyword:c,curTool:s,curMode:_,selectedStuff:p,isSearching:y,clearKeyWord:()=>{c.value=""},toggleStuff:u,toggleTools:C,reset:b,setMode:R,addStuff:g,displayedRecipe:F,clickTool:I}}),me={class:"fixed z-9 inline-flex cursor-pointer items-center justify-center rounded rounded-full shadow hover:shadow-md",bg:"green-50 dark:green-900",w:"10",h:"10",bottom:"22",right:"4",text:"green-600 dark:green-300"},ge={key:0},ye=e("div",{"i-mdi-bowl-mix-outline":""},null,-1),ke=[ye],xe={key:1},$e=e("div",{"i-mdi-bowl-outline":""},null,-1),be=[$e],we=$({__name:"BasketButton",props:{isVisible:Boolean},setup(d){const t=d,c=V(),{displayedRecipe:i}=K(c),s=M(()=>i.value.length!==c.recipesLength&&t.isVisible);return(_,p)=>Q((n(),l("button",me,[a(i).length>0?(n(),l("span",ge,ke)):(n(),l("span",xe,be))],512)),[[Z,a(s)]])}}),Se={},Ce={text:"xl",font:"bold",p:"1"};function Te(d,t){return n(),l("div",Ce," 🍲 来看看组合出的菜谱吧！ ")}const Be=H(Se,[["render",Te]]),je=["bg","text","onClick"],Ve=$({__name:"ToggleMode",setup(d){const t=V(),c=[{id:"loose",name:"模糊匹配"},{id:"strict",name:"严格匹配"},{id:"survival",name:"生存模式"}];return(i,s)=>(n(),l("div",null,[(n(),l(S,null,B(c,_=>e("button",{key:_.id,class:"rounded px-2 tag",bg:_.id===a(t).curMode?"orange-500 dark:orange-600 opacity-100":"orange-300 opacity-20",text:_.id===a(t).curMode?"orange-100":"orange-800 dark:orange-200",onClick:p=>a(t).setMode(_.id)},k(_.name),9,je)),64))]))}}),Re={m:"auto b-2","max-w":"500px"},Fe={relative:"","text-xs":""},Me=e("div",{"i-ri-close-line":""},null,-1),Ee=[Me],Ae=e("label",{class:"hidden",for:"input"},"快速搜索",-1),De=$({__name:"SearchFoodInput",setup(d){const t=V(),c=m();return Y(()=>{var i;(i=c.value)==null||i.focus()}),(i,s)=>(n(),l("div",Re,[e("div",Fe,[a(t).keyword?(n(),l("div",{key:0,cursor:"pointer",absolute:"","right-2":"","inline-flex":"",justify:"center","items-center":"",h:"full",opacity:"70",onClick:s[0]||(s[0]=_=>a(t).clearKeyWord())},Ee)):D("",!0),Q(e("input",{id:"input",ref_key:"searchInput",ref:c,"onUpdate:modelValue":s[1]||(s[1]=_=>a(t).keyword=_),placeholder:"关键字过滤","aria-label":"搜索关键字",type:"text",autocomplete:"false",p:"x4 y2",w:"full",text:"center",bg:"white dark:dark-800",border:"~ rounded gray-200 dark:gray-700",class:"focus:dark:gray-500"},null,512),[[ee,a(t).keyword]]),Ae])]))}}),Ie={class:"recipe-panel relative shadow transition hover:shadow-md",m:"x-2 y-4",p:"2",bg:"gray-400/8"},Le={key:0,"i-ri-search-line":""},Ne={key:1,"i-ri-search-fill":""},Pe={class:"cook-recipes",p:"2"},ze={key:0,text:"sm",p:"2"},qe={key:1,relative:"",flex:"","items-center":"","justify-center":"","p-6":"","text-xl":""},Ke=e("div",{class:"magnifying-glass","i-ri-search-line":"","inline-flex":""},null,-1),Ye=[Ke],Je={key:2},Qe={key:3,text:"sm"},We=e("span",null,"还没有完美匹配的菜谱呢……",-1),Ge=e("br",null,null,-1),He=e("span",null,"大胆尝试一下，或者",-1),Ue=e("strong",null,"换个组合",-1),Oe=[Ue],Xe=e("span",null,"？",-1),Ze=e("br",null,null,-1),et=e("div",{m:"t-1"},[e("span",null,"欢迎来"),e("a",{class:"text-blue-600 font-bold dark:text-blue-400",href:"https://docs.qq.com/sheet/DQk1vdkhFV0twQVNS?tab=uykkic",target:"_blank"},"这里"),e("span",null,"反馈新的菜谱！")],-1),tt=$({__name:"RecipePanel",setup(d){const t=V(),{selectedStuff:c,curTool:i}=K(t),s=m(!1),_=M(()=>!c.value.length&&!i.value);return(p,u)=>{const C=Be,R=Ve,b=De,g=le;return n(),l("div",Ie,[x(C),x(R),e("button",{absolute:"","right-4":"","top-4":"",onClick:u[0]||(u[0]=y=>s.value=!a(s))},[a(s)?(n(),l("div",Ne)):(n(),l("div",Le))]),e("div",Pe,[a(s)?(n(),j(b,{key:0})):D("",!0),x(W,{mode:"out-in"},{default:T(()=>[a(_)?(n(),l("span",ze," 你要先选食材或工具哦～ ")):a(t).isSearching?(n(),l("div",qe,Ye)):a(t).displayedRecipe.length?(n(),l("div",Je,[(n(!0),l(S,null,B(a(t).displayedRecipe,(y,w)=>(n(),j(g,{key:w,dish:y},null,8,["dish"]))),128))])):(n(),l("div",Qe,[We,Ge,He,e("a",{href:"#",onClick:u[1]||(u[1]=y=>a(t).reset())},Oe),Xe,Ze,et]))]),_:1})])])}}});function nt(d){const{top:t}=G(d);return{isVisible:M(()=>z?window.scrollY<t.value:!0),show:()=>{z&&window.scrollTo(0,t.value)}}}function ot(d){const{x:t,y:c}=te(),{top:i,left:s}=G(d);return{playAnimation:p=>{if(!z)return;const u=document.createElement("span");u.style.position="fixed",u.style.left=`${t.value}px`,u.style.top=`${c.value}px`,u.style.zIndex="10",u.style.transition="left .4s linear, top .4s cubic-bezier(0.5, -0.5, 1, 1)",u.textContent=p,document.body.appendChild(u),setTimeout(()=>{!i.value||!s.value?(u.style.top=`${t.value}px`,u.style.left=`${c.value}px`):(u.style.top=`${i.value}px`,u.style.left=`${s.value+12}px`)},1),u.ontransitionend=()=>{u.remove()}}}}const st=e("h2",{m:"t-4",text:"xl",font:"bold",p:"1"}," 🥘 先选一下食材 ",-1),lt=e("h2",{opacity:"90",text:"base",font:"bold",p:"1"}," 🥬 菜菜们 ",-1),at={key:0,class:"inline-flex"},it={key:1,class:"inline-flex"},ct=["src","alt"],rt={class:"inline-flex",m:"l-1"},ut={m:"y-4"},dt=e("h2",{opacity:"90",text:"base",font:"bold",p:"1"}," 🥩 肉肉们 ",-1),_t={m:"l-1"},pt={m:"y-4"},ft=e("h2",{opacity:"90",text:"base",font:"bold",p:"1"}," 🍚 主食也要一起下锅吗？（不选也行） ",-1),vt={m:"l-1"},ht={m:"t-4"},mt=e("h2",{text:"xl",font:"bold",p:"1"}," 🍳 再选一下厨具 ",-1),gt={key:0,class:"inline-flex"},yt={key:1,class:"inline-flex"},kt={class:"inline-flex",m:"l-1"},xt=$({__name:"ChooseFood",setup(d){const t=V(),{curTool:c}=K(t),i=M(()=>t.selectedStuff),s=m(),{playAnimation:_}=ot(s),p=J(),u=m(),{isVisible:C,show:R}=nt(u);function b(g,y="",w){t.toggleStuff(g.name),i.value.includes(g.name)&&_(g.emoji),p==null||p.trackEvent({event:"click",category:`${y}_${g.name}`,action:"click_stuff",label:"食材"}),p==null||p.trackEvent({event:"click_stuff",action:g.name})}return(g,y)=>{const w=_e,F=fe,I=se,E=he,r=we,f=tt;return n(),l("div",null,[st,e("div",null,[lt,e("div",null,[(n(!0),l(S,null,B(a(ae),(o,v)=>(n(),j(w,{key:v,active:a(i).includes(o.name),onClick:h=>b(o,"vegetable")},{default:T(()=>[o.emoji?(n(),l("span",at,k(o.emoji),1)):o.image?(n(),l("span",it,[e("img",{class:"inline-flex",w:"2",h:"2",width:"10",height:"10",src:o.image,alt:o.name},null,8,ct)])):D("",!0),e("span",rt,k(o.name),1)]),_:2},1032,["active","onClick"]))),128))])]),e("div",ut,[dt,e("div",null,[(n(!0),l(S,null,B(a(ie),(o,v)=>(n(),j(F,{key:v,active:a(i).includes(o.name),onClick:h=>b(o,"meat")},{default:T(()=>[e("span",null,k(o.emoji),1),e("span",_t,k(o.name),1)]),_:2},1032,["active","onClick"]))),128))])]),e("div",pt,[ft,e("div",null,[(n(!0),l(S,null,B(a(ce),(o,v)=>(n(),j(I,{key:v,active:a(i).includes(o.name),onClick:h=>b(o,"staple")},{default:T(()=>[e("span",null,k(o.emoji),1),e("span",vt,k(o.name),1)]),_:2},1032,["active","onClick"]))),128))])]),e("div",ht,[mt,e("div",null,[(n(!0),l(S,null,B(a(re),(o,v)=>(n(),j(E,{key:v,active:a(c)===o.name,onClick:h=>a(t).clickTool(o)},{default:T(()=>[o.emoji?(n(),l("span",gt,k(o.emoji),1)):o.icon?(n(),l("span",yt,[e("div",{class:ne(o.icon)},null,2)])):D("",!0),e("span",kt,k(o.label||o.name),1)]),_:2},1032,["active","onClick"]))),128))])]),x(W,null,{default:T(()=>[x(r,{ref_key:"recipeBtnRef",ref:s,"is-visible":a(C),onClick:a(R)},null,8,["is-visible","onClick"])]),_:1}),x(f,{ref_key:"recipePanelRef",ref:u},null,512)])}}}),$t={},bt={text:"center sm","my-3":""},wt=e("div",{flex:"~","items-center":"","justify-center":"",gap:"2"},[e("a",{href:"https://github.com/YunYouJun/cook",target:"_blank",class:"inline-flex items-center justify-center"},[e("div",{"i-ri-github-line":"","mr-1":""}),e("span",null,"Code")]),oe(" by "),e("a",{href:"https://www.bilibili.com/opus/649847454294868008",target:"_blank",class:"inline-flex items-center justify-center"},[e("div",{"i-ri-bilibili-line":"","mr-1":"",class:"text-pink-400"}),e("span",null,"云游君")])],-1);function St(d,t){const c=ue;return n(),l("div",bt,[x(c),wt])}const Ct=H($t,[["render",St]]),Tt={"text-4xl":""},Bt={key:0,"i-mdi-pot-steam-outline":""},jt={key:1,"i-mdi-pot-mix-outline":""},Vt=e("p",{text:"sm",m:"b-4"}," 好的，今天我们来做菜！ ",-1),Dt=$({__name:"index",setup(d){const t=V();return(c,i)=>{const s=xt,_=Ct;return n(),l(S,null,[e("div",Tt,[e("button",{class:"cursor-pointer transition active:text-green-800 hover:text-green-600",title:"重置",onClick:i[0]||(i[0]=(...p)=>a(t).reset&&a(t).reset(...p))},[a(t).selectedStuff.length?(n(),l("div",Bt)):(n(),l("div",jt))])]),Vt,x(s),x(_)],64)}}});export{Dt as default};
